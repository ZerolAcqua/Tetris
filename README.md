# 俄罗斯方块 (Tetris)

一个使用 LÖVE 2D 引擎开发的现代俄罗斯方块游戏实现。

## 游戏特色

- 🎮 **完整的游戏机制**：包含标准俄罗斯方块的所有核心功能
- 🔄 **现代旋转系统**：支持踢墙（Wall Kick）机制
- ⏸️ **Hold 功能**：可以暂存方块供后续使用
- 🎲 **7-bag 随机系统**：确保方块分布的公平性
- 🔒 **锁延机制**：提供更好的操作体验
- 📱 **简洁界面**：清晰的游戏界面和预览区域

## 系统要求

- [LÖVE 2D](https://love2d.org/) 游戏引擎
- 支持的操作系统：Windows、macOS、Linux

## 安装与运行

### 本地运行

1. 下载并安装 LÖVE 2D 引擎
2. 克隆或下载此项目到本地
3. 将整个项目文件夹拖拽到 LÖVE 可执行文件上，或在命令行中运行：
   ```bash
   love /path/to/Tetris
   ```

### 编译为网页版

使用 [love.js](https://github.com/Davidobot/love.js) 可以将游戏编译为网页版本，在浏览器中运行。

#### 准备工作

1. 安装 Node.js 和 npm
2. 安装 love.js：
   ```bash
   npm install -g love.js
   ```

#### 编译为网页版

1. 使用 love.js 编译：
   ```bash
   npx love.js src out -c -t Tetris
   ```
   
   参数说明：
   - `src`: 输入的工程目录
   - `out`: 输出目录名称
   - `-c`: 启用兼容模式
   - `-t Tetris`: 游戏标题

2. 编译完成后，在 `out` 目录中会生成网页版文件
3. 使用本地服务器运行（不能直接打开 HTML 文件）：
   ```bash
   # 使用 Node.js 的 http-server
   npx http-server out
   ```

4. 在浏览器中访问 `http://localhost:8000` 即可游玩网页版

#### 注意事项

- 网页版可能在某些功能上与桌面版略有差异
- 建议使用现代浏览器以获得最佳体验
- 首次加载可能需要一些时间来下载和初始化游戏资源

## 操作控制

| 按键 | 功能 |
|------|------|
| ⬅️ | 向左移动 |
| ➡️ | 向右移动 |
| ⬇️ | 软降（下降到底部） |
| Space | 硬降（瞬间下降） |
| Z | 逆时针旋转 |
| X | 顺时针旋转 |
| A | 180度旋转 |
| C | Hold（暂存当前方块） |
| Esc | 退出游戏 |

## 游戏机制

### 方块系统
- 包含标准的 7 种俄罗斯方块：I、J、L、O、S、Z、T
- 每种方块都有 4 个旋转状态
- 采用标准的颜色配色方案

### 旋转与踢墙
- 实现了 SRS（Super Rotation System）踢墙机制
- 支持多种旋转方式：逆时针、顺时针、180度旋转
- 智能碰撞检测和位置调整

### 锁延系统
- 方块落地后有 1 秒的锁延时间
- 锁延期间可进行最多 15 次移动或旋转操作
- 每次操作会重置锁延计时器

### Hold 机制
- 每轮游戏可使用一次 Hold 功能
- 可以暂存当前方块，换取之前暂存的方块
- Hold 区域位于游戏界面右下方

### 随机系统
- 采用 7-bag 随机算法
- 确保每 7 个方块中包含所有 7 种类型
- 提供 5 个方块的预览序列

## 项目结构

```
Tetris/
├── package.json          # Node.js 项目配置文件
├── package-lock.json     # 依赖包版本锁定文件
├── readme                # 项目说明文档
└── src/                  # 游戏源代码目录
    ├── main.lua              # 主程序入口，游戏循环和事件处理
    ├── conf.lua              # LÖVE 引擎配置文件
    ├── gameModule.lua        # 游戏逻辑核心模块
    ├── drawModule.lua        # 渲染和绘制模块
    ├── blockData.lua         # 方块数据定义（形状、颜色、踢墙表等）
    ├── sequenceModule.lua    # 方块序列生成模块
    └── backup/               # 备份文件夹
        ├── blockData.lua
        └── blockData(fool).lua
```

## 技术实现

### 核心模块说明

- **main.lua**: 处理游戏主循环、用户输入和事件分发
- **gameModule.lua**: 实现游戏逻辑，包括方块移动、旋转、碰撞检测、消行等
- **drawModule.lua**: 负责所有图形渲染，包括游戏场地、当前方块、预览和 Hold 区域
- **blockData.lua**: 存储所有方块的形状数据、颜色配置和踢墙查找表
- **sequenceModule.lua**: 实现 7-bag 随机算法和方块序列管理

### 关键特性

1. **模块化设计**: 代码按功能分离到不同模块，便于维护和扩展
2. **精确碰撞检测**: 使用位标记优化碰撞检测性能
3. **标准踢墙实现**: 完整实现了俄罗斯方块的标准踢墙机制
4. **可配置参数**: 游戏参数（如下降速度、锁延时间等）便于调整

## 开发特点

- 使用 Lua 语言开发，代码简洁易读
- 采用面向对象的模块化架构
- 实现了现代俄罗斯方块的标准特性
- 支持多种旋转和移动操作
- 包含完整的游戏状态管理

## 许可证

本项目为开源项目，欢迎贡献代码和提出改进建议。

## 贡献

如果您想为项目做出贡献，请：
1. Fork 本仓库
2. 创建您的特性分支
3. 提交您的更改
4. 创建 Pull Request